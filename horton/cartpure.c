// Horton is a Density Functional Theory program.
// Copyright (C) 2011-2012 Toon Verstraelen <Toon.Verstraelen@UGent.be>
//
// This file is part of Horton.
//
// Horton is free software; you can redistribute it and/or
// modify it under the terms of the GNU General Public License
// as published by the Free Software Foundation; either version 3
// of the License, or (at your option) any later version.
//
// Horton is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program; if not, see <http://www.gnu.org/licenses/>
//
//--


#include "cartpure.h"
#include "assert.h"


typedef struct {
    int ipure, icart;
    double x;
} type_sparse_el;


const static type_sparse_el cptf0[] = {
    { 0,  0, 1.0},
};
const static type_sparse_el cptf1[] = {
    { 0,  2, 1.0},
    { 1,  0, 1.0},
    { 2,  1, 1.0},
};
const static type_sparse_el cptf2[] = {
    { 0,  0, -1.0},
    { 0,  3, -0.5},
    { 0,  5, 1.5},
    { 1,  2, 1.0},
    { 2,  4, 1.0},
    { 3,  0, 0.86602540378443864676},
    { 3,  3, -0.86602540378443864676},
    { 4,  1, 1.0},
};
const static type_sparse_el cptf3[] = {
    { 0,  2, -1.3416407864998738178},
    { 0,  7, -0.67082039324993690892},
    { 0,  9, 2.5},
    { 1,  0, -1.2247448713915890491},
    { 1,  3, -0.27386127875258305673},
    { 1,  5, 1.3693063937629152836},
    { 2,  1, -0.54772255750516611346},
    { 2,  6, -0.61237243569579452455},
    { 2,  8, 1.3693063937629152836},
    { 3,  2, 0.86602540378443864676},
    { 3,  7, -0.86602540378443864676},
    { 4,  4, 1.0},
    { 5,  0, 0.790569415042094833},
    { 5,  3, -1.0606601717798212866},
    { 6,  1, 1.0606601717798212866},
    { 6,  6, -0.790569415042094833},
};
const static type_sparse_el cptf4[] = {
    { 0,  0, 1.5},
    { 0,  3, 0.43915503282683993071},
    { 0,  5, -2.1957751641341996535},
    { 0, 10, 0.375},
    { 0, 12, -1.0978875820670998268},
    { 0, 14, 4.375},
    { 1,  2, -1.79284291400159046},
    { 1,  7, -0.40089186286863657703},
    { 1,  9, 2.0916500663351888699},
    { 2,  4, -0.80178372573727315405},
    { 2, 11, -0.89642145700079522998},
    { 2, 13, 2.0916500663351888699},
    { 3,  0, -1.1180339887498948482},
    { 3,  3, 0.16366341767699428595},
    { 3,  5, 1.1456439237389600016},
    { 3, 10, 0.5590169943749474241},
    { 3, 12, -1.1456439237389600016},
    { 4,  1, -0.84515425472851657751},
    { 4,  6, -0.42257712736425828875},
    { 4,  8, 1.3228756555322952953},
    { 5,  2, 0.790569415042094833},
    { 5,  7, -1.0606601717798212866},
    { 6,  4, 1.0606601717798212866},
    { 6, 11, -0.790569415042094833},
    { 7,  0, 0.73950997288745200532},
    { 7,  3, -1.2990381056766579701},
    { 7, 10, 0.73950997288745200532},
    { 8,  1, 1.1180339887498948482},
    { 8,  6, -1.1180339887498948482},
};
const static type_sparse_el cptf5[] = {
    { 0,  2, 2.5},
    { 0,  7, 0.73192505471139988452},
    { 0,  9, -3.8188130791298666722},
    { 0, 16, 0.625},
    { 0, 18, -1.9094065395649333361},
    { 0, 20, 7.875},
    { 1,  0, 1.9364916731037084426},
    { 1,  3, 0.42257712736425828875},
    { 1,  5, -2.9580398915498080213},
    { 1, 10, 0.16137430609197570355},
    { 1, 12, -0.66143782776614764763},
    { 1, 14, 3.3888604279314897745},
    { 2,  1, 0.6454972243679028142},
    { 2,  6, 0.42257712736425828875},
    { 2,  8, -1.3228756555322952953},
    { 2, 15, 0.48412291827592711065},
    { 2, 17, -1.4790199457749040106},
    { 2, 19, 3.3888604279314897745},
    { 3,  2, -1.7078251276599330639},
    { 3,  7, 0.25},
    { 3,  9, 1.6770509831248422723},
    { 3, 16, 0.85391256382996653194},
    { 3, 18, -1.6770509831248422723},
    { 4,  4, -1.2909944487358056284},
    { 4, 11, -0.6454972243679028142},
    { 4, 13, 1.9364916731037084426},
    { 5,  0, -1.045825033167594435},
    { 5,  3, 0.57054433073454803485},
    { 5,  5, 1.0269797953221864627},
    { 5, 10, 0.52291251658379721749},
    { 5, 12, -1.3778379803155376802},
    { 6,  1, -1.045825033167594435},
    { 6,  6, -0.11410886614690960697},
    { 6,  8, 1.3778379803155376802},
    { 6, 15, 0.52291251658379721749},
    { 6, 17, -1.0269797953221864627},
    { 7,  2, 0.73950997288745200532},
    { 7,  7, -1.2990381056766579701},
    { 7, 16, 0.73950997288745200532},
    { 8,  4, 1.1180339887498948482},
    { 8, 11, -1.1180339887498948482},
    { 9,  0, 0.7015607600201140098},
    { 9,  3, -1.5309310892394863114},
    { 9, 10, 1.169267933366856683},
    {10,  1, 1.169267933366856683},
    {10,  6, -1.5309310892394863114},
    {10, 15, 0.7015607600201140098},
};
const static type_sparse_el cptf6[] = {
    { 0,  0, -2.5},
    { 0,  3, -0.65279120983386689316},
    { 0,  5, 4.5695384688370682522},
    { 0, 10, -0.32639560491693344658},
    { 0, 12, 1.3378238775237670547},
    { 0, 14, -6.8543077032556023782},
    { 0, 21, -0.3125},
    { 0, 23, 1.142384617209267063},
    { 0, 25, -3.4271538516278011891},
    { 0, 27, 14.4375},
    { 1,  2, 3.454246398538787189},
    { 1,  7, 0.75377836144440905662},
    { 1,  9, -5.0564989684743156468},
    { 1, 16, 0.28785386654489893242},
    { 1, 18, -1.1306675421666135849},
    { 1, 20, 5.6995065575889988619},
    { 2,  4, 1.1514154661795957297},
    { 2, 11, 0.75377836144440905662},
    { 2, 13, -2.2613350843332271699},
    { 2, 22, 0.86356159963469679725},
    { 2, 24, -2.5282494842371578234},
    { 2, 26, 5.6995065575889988619},
    { 3,  0, 1.8114220932736798217},
    { 3,  5, -2.8379530074910107164},
    { 3, 10, -0.23649608395758422636},
    { 3, 12, 0.41543378205524797298},
    { 3, 14, 2.60145692353342649},
    { 3, 21, -0.45285552331841995543},
    { 3, 23, 1.4189765037455053582},
    { 3, 25, -2.60145692353342649},
    { 4,  1, 1.0923286218816287072},
    { 4,  6, 0.53300179088902608575},
    { 4,  8, -2.1452908258025827098},
    { 4, 15, 0.27308215547040717681},
    { 4, 17, -1.0726454129012913549},
    { 4, 19, 3.0039037101744789449},
    { 5,  2, -1.6384929328224430609},
    { 5,  7, 0.89387117741774279573},
    { 5,  9, 1.4657549249448217358},
    { 5, 16, 0.81924646641122153043},
    { 5, 18, -1.9665165903190341506},
    { 6,  4, -1.6384929328224430609},
    { 6, 11, -0.17877423548354855915},
    { 6, 13, 1.9665165903190341506},
    { 6, 22, 0.81924646641122153043},
    { 6, 24, -1.4657549249448217358},
    { 7,  0, -0.99215674164922147144},
    { 7,  3, 0.94991775959816647698},
    { 7,  5, 0.94991775959816647698},
    { 7, 10, 0.3454246398538787189},
    { 7, 12, -1.6686446595965241635},
    { 7, 21, -0.49607837082461073572},
    { 7, 23, 0.94991775959816647698},
    { 8,  1, -1.1965860528261984628},
    { 8,  6, 0.29193710406057111409},
    { 8,  8, 1.436140661634507165},
    { 8, 15, 0.59829302641309923139},
    { 8, 17, -1.436140661634507165},
    { 9,  2, 0.7015607600201140098},
    { 9,  7, -1.5309310892394863114},
    { 9, 16, 1.169267933366856683},
    {10,  4, 1.169267933366856683},
    {10, 11, -1.5309310892394863114},
    {10, 22, 0.7015607600201140098},
    {11,  0, 0.67169328938139615748},
    {11,  3, -1.7539019000502850245},
    {11, 10, 1.7539019000502850245},
    {11, 21, -0.67169328938139615748},
    {12,  1, 1.2151388809514737933},
    {12,  6, -1.9764235376052370825},
    {12, 15, 1.2151388809514737933},
};
const static type_sparse_el cptf7[] = {
    { 0,  2, -4.8536267169707548177},
    { 0,  7, -1.2673619426613273945},
    { 0,  9, 8.5017223676607563508},
    { 0, 16, -0.63368097133066369723},
    { 0, 18, 2.4890494436364925025},
    { 0, 20, -12.546883232347141205},
    { 0, 29, -0.60670333962134435221},
    { 0, 31, 2.1254305919151890877},
    { 0, 33, -6.2734416161735706025},
    { 0, 35, 26.8125},
    { 1,  0, -3.3071891388307382381},
    { 1,  3, -0.7185266831549085941},
    { 1,  5, 6.4667401483941773469},
    { 1, 10, -0.26777908453030477841},
    { 1, 12, 1.4111583918869656756},
    { 1, 14, -8.8367097895000576875},
    { 1, 21, -0.1146561540164598136},
    { 1, 23, 0.53889501236618144557},
    { 1, 25, -1.9759483786759986338},
    { 1, 27, 9.8374980146122520069},
    { 2,  1, -0.9172492321316785088},
    { 2,  6, -0.53555816906060955682},
    { 2,  8, 2.1555800494647257823},
    { 2, 15, -0.35926334157745429705},
    { 2, 17, 1.4111583918869656756},
    { 2, 19, -3.9518967573519972675},
    { 2, 28, -0.41339864235384227977},
    { 2, 30, 1.6166850370985443367},
    { 2, 32, -4.4183548947500288438},
    { 2, 34, 9.8374980146122520069},
    { 3,  2, 3.3701888785234392146},
    { 3,  9, -4.8100955531849084847},
    { 3, 16, -0.44000593507599178985},
    { 3, 18, 0.70412589018638508714},
    { 3, 20, 4.1947232477244550633},
    { 3, 29, -0.84254721963085980365},
    { 3, 31, 2.4050477765924542424},
    { 3, 33, -4.1947232477244550633},
    { 4,  4, 2.0323003604892548571},
    { 4, 11, 0.99166103502739704631},
    { 4, 13, -3.6360904617671225032},
    { 4, 22, 0.50807509012231371428},
    { 4, 24, -1.8180452308835612516},
    { 4, 26, 4.8436491924993907428},
    { 5,  0, 1.7184658856084400025},
    { 5,  3, -0.4978098887272985005},
    { 5,  5, -2.7379543880001417528},
    { 5, 10, -0.5101876775718459531},
    { 5, 12, 1.493676575279421572},
    { 5, 14, 2.2108132694779991301},
    { 5, 21, -0.35746251148251142922},
    { 5, 23, 1.3689771940000708764},
    { 5, 25, -2.9661172536668202322},
    { 6,  1, 1.4298500459300457169},
    { 6,  6, 0.37104558368861523862},
    { 6,  8, -2.7379543880001417528},
    { 6, 15, -0.062226236090912312563},
    { 6, 17, -0.29873531505588431441},
    { 6, 19, 2.9661172536668202322},
    { 6, 28, -0.42961647140211000062},
    { 6, 30, 1.3689771940000708764},
    { 6, 32, -2.2108132694779991301},
    { 7,  2, -1.580758702940798907},
    { 7,  7, 1.5134612330172695395},
    { 7,  9, 1.3331705629813463594},
    { 7, 16, 0.55034953927900710528},
    { 7, 18, -2.3418742493993993272},
    { 7, 29, -0.79037935147039945351},
    { 7, 31, 1.3331705629813463594},
    { 8,  4, -1.9064667279067276225},
    { 8, 11, 0.46513025470953171071},
    { 8, 13, 2.0155644370746374131},
    { 8, 22, 0.95323336395336381126},
    { 8, 24, -2.0155644370746374131},
    { 9,  0, -0.94991775959816647698},
    { 9,  3, 1.307080155787641875},
    { 9,  5, 0.89431800132838654608},
    { 9, 12, -1.9515618744994994393},
    { 9, 21, -0.65864945955866621126},
    { 9, 23, 1.4905300022139775768},
    {10,  1, -1.3172989191173324225},
    {10,  6, 0.76913686325846905352},
    {10,  8, 1.4905300022139775768},
    {10, 15, 0.55034953927900710528},
    {10, 17, -1.9515618744994994393},
    {10, 28, -0.47495887979908323849},
    {10, 30, 0.89431800132838654608},
    {11,  2, 0.67169328938139615748},
    {11,  7, -1.7539019000502850245},
    {11, 16, 1.7539019000502850245},
    {11, 29, -0.67169328938139615748},
    {12,  4, 1.2151388809514737933},
    {12, 11, -1.9764235376052370825},
    {12, 22, 1.2151388809514737933},
    {13,  0, 0.64725984928774934788},
    {13,  3, -1.96875},
    {13, 10, 2.4456993503903949804},
    {13, 21, -1.2566230789301937693},
    {14,  1, 1.2566230789301937693},
    {14,  6, -2.4456993503903949804},
    {14, 15, 1.96875},
    {14, 28, -0.64725984928774934788},
};
const static type_sparse_el cptf8[] = {
    { 0,  0, 4.375},
    { 0,  3, 1.0853039276555739917},
    { 0,  5, -9.767735348900165925},
    { 0, 10, 0.48398183626265131993},
    { 0, 12, -2.5505167102982269052},
    { 0, 14, 15.971400596667493558},
    { 0, 21, 0.27132598191389349792},
    { 0, 23, -1.2752583551491134526},
    { 0, 25, 4.675947302213415993},
    { 0, 27, -23.279769248212062121},
    { 0, 36, 0.2734375},
    { 0, 38, -1.2209669186125207406},
    { 0, 40, 3.9928501491668733895},
    { 0, 42, -11.639884624106031061},
    { 0, 44, 50.2734375},
    { 1,  2, -6.7777208558629795491},
    { 1,  7, -1.4725415092633200551},
    { 1,  9, 12.073244019477373002},
    { 1, 16, -0.54878381906715331828},
    { 1, 18, 2.634597838234664845},
    { 1, 20, -15.695217225320584903},
    { 1, 29, -0.23497519304418891392},
    { 1, 31, 1.0061036682897810835},
    { 1, 33, -3.5095572637442461312},
    { 1, 35, 17.307394328364394206},
    { 2,  4, -1.8798015443535113113},
    { 2, 11, -1.0975676381343066366},
    { 2, 13, 4.024414673159124334},
    { 2, 22, -0.73627075463166002753},
    { 2, 24, 2.634597838234664845},
    { 2, 26, -7.0191145274884922624},
    { 2, 37, -0.84721510698287244363},
    { 2, 39, 3.0183110048693432505},
    { 2, 41, -7.8476086126602924514},
    { 2, 43, 17.307394328364394206},
    { 3,  0, -3.1374750995027833049},
    { 3,  3, -0.1945779456235390596},
    { 3,  5, 6.4210722055767889668},
    { 3, 10, 0.1735406811297944831},
    { 3, 14, -8.2721058005202036947},
    { 3, 21, 0.2432224320294238245},
    { 3, 23, -0.83832389870181762856},
    { 3, 25, 1.2109122981248476857},
    { 3, 27, 6.9561615560415213807},
    { 3, 36, 0.39218438743784791311},
    { 3, 38, -1.6052680513941972417},
    { 3, 40, 4.1360529002601018473},
    { 3, 42, -6.9561615560415213807},
    { 4,  1, -1.6201851746019650577},
    { 4,  6, -0.78710654506662138841},
    { 4,  8, 3.8720522286687277507},
    { 4, 15, -0.3935532725333106942},
    { 4, 17, 1.8893680262091709436},
    { 4, 19, -6.2531242191403810301},
    { 4, 28, -0.20252314682524563222},
    { 4, 30, 0.96801305716718193767},
    { 4, 32, -3.1265621095701905151},
    { 4, 34, 8.0322834938141967948},
    { 5,  2, 3.2906116452720457727},
    { 5,  7, -0.95323336395336381126},
    { 5,  9, -4.618238300477791499},
    { 5, 16, -0.97693502510107127862},
    { 5, 18, 2.5194555463432967664},
    { 5, 20, 3.4636787253583436242},
    { 5, 29, -0.68448859700003543819},
    { 5, 31, 2.3091191502388957495},
    { 5, 33, -4.6470126492726485799},
    { 6,  4, 2.7379543880001417528},
    { 6, 11, 0.71049820007350638445},
    { 6, 13, -4.618238300477791499},
    { 6, 22, -0.11915417049417047641},
    { 6, 24, -0.50389110926865935327},
    { 6, 26, 4.6470126492726485799},
    { 6, 37, -0.82265291131801144316},
    { 6, 39, 2.3091191502388957495},
    { 6, 41, -3.4636787253583436242},
    { 7,  0, 1.6453058226360228863},
    { 7,  3, -1.0203753551436919062},
    { 7,  5, -2.6529759233735989561},
    { 7, 10, -0.5763681726402771346},
    { 7, 12, 2.5400310652627853244},
    { 7, 14, 1.9717858537693691447},
    { 7, 21, -0.10203753551436919062},
    { 7, 23, 0.92364766009555829979},
    { 7, 25, -3.4636787253583436242},
    { 7, 36, 0.41132645565900572158},
    { 7, 38, -1.3264879616867994781},
    { 7, 40, 1.9717858537693691447},
    { 8,  1, 1.6992645467966428446},
    { 8,  8, -3.1996093511552312626},
    { 8, 15, -0.41276215445925532896},
    { 8, 17, 0.78062474979979977573},
    { 8, 19, 2.9810600044279551536},
    { 8, 28, -0.42481613669916071115},
    { 8, 30, 1.5998046755776156313},
    { 8, 32, -2.9810600044279551536},
    { 9,  2, -1.5316963635133433325},
    { 9,  7, 2.1076034227292382152},
    { 9,  9, 1.2401959270615268393},
    { 9, 18, -2.7063293868263707711},
    { 9, 29, -1.0620403417479017779},
    { 9, 31, 2.0669932117692113988},
    {10,  4, -2.1240806834958035558},
    {10, 11, 1.2401959270615268393},
    {10, 13, 2.0669932117692113988},
    {10, 22, 0.88741196746494240639},
    {10, 24, -2.7063293868263707711},
    {10, 37, -0.76584818175667166625},
    {10, 39, 1.2401959270615268393},
    {11,  0, -0.91536365724230061329},
    {11,  3, 1.6462848800405110931},
    {11,  5, 0.8515266620899195309},
    {11, 10, -0.50630786706311408054},
    {11, 12, -2.2234764798058917178},
    {11, 21, -0.73798977381126359345},
    {11, 23, 2.2234764798058917178},
    {11, 36, 0.45768182862115030664},
    {11, 38, -0.8515266620899195309},
    {12,  1, -1.4180752800891777762},
    {12,  6, 1.3012914258535633647},
    {12,  8, 1.5404696929832796941},
    {12, 15, 0.30618621784789726227},
    {12, 17, -2.5055741429289786064},
    {12, 28, -0.70903764004458888811},
    {12, 30, 1.5404696929832796941},
    {13,  2, 0.64725984928774934788},
    {13,  7, -1.96875},
    {13, 16, 2.4456993503903949804},
    {13, 29, -1.2566230789301937693},
    {14,  4, 1.2566230789301937693},
    {14, 11, -2.4456993503903949804},
    {14, 22, 1.96875},
    {14, 37, -0.64725984928774934788},
    {15,  0, 0.626706654240043952},
    {15,  3, -2.176535018670731151},
    {15, 10, 3.2353561313826025233},
    {15, 21, -2.176535018670731151},
    {15, 36, 0.626706654240043952},
    {16,  1, 1.2945196985754986958},
    {16,  6, -2.9348392204684739765},
    {16, 15, 2.9348392204684739765},
    {16, 28, -1.2945196985754986958},
};
const static type_sparse_el cptf9[] = {
    { 0,  2, 9.5498402358056108323},
    { 0,  7, 2.369023798034985675},
    { 0,  9, -19.423426926643522487},
    { 0, 16, 1.0564455344777487115},
    { 0, 18, -5.0717769450253328089},
    { 0, 20, 30.214342286063613149},
    { 0, 29, 0.59225594950874641875},
    { 0, 31, -2.5358884725126664045},
    { 0, 33, 8.8458536523184292458},
    { 0, 35, -43.623359251970389588},
    { 0, 46, 0.59686501473785067702},
    { 0, 48, -2.4279283658304403109},
    { 0, 50, 7.5535855715159032872},
    { 0, 52, -21.811679625985194794},
    { 0, 54, 94.9609375},
    { 1,  0, 5.8696784409369479531},
    { 1,  3, 1.273312031440748111},
    { 1,  5, -14.006432345848229221},
    { 1, 10, 0.47245680592366878116},
    { 1, 12, -3.0430661670151996854},
    { 1, 14, 22.520441082361545235},
    { 1, 21, 0.19741864983624880625},
    { 1, 23, -1.1340838015792858007},
    { 1, 25, 4.9143631401769051365},
    { 1, 27, -28.230866926583579294},
    { 1, 36, 0.088975383089683195547},
    { 1, 38, -0.48558567316608806218},
    { 1, 40, 1.8767034235301287696},
    { 1, 42, -6.3126137511591448083},
    { 1, 44, 30.899879470145692625},
    { 2,  1, 1.4236061294349311288},
    { 2,  6, 0.789674599344995225},
    { 2,  8, -3.8846853853287044974},
    { 2, 15, 0.47245680592366878116},
    { 2, 17, -2.2681676031585716015},
    { 2, 19, 7.5068136941205150784},
    { 2, 28, 0.31832800786018702774},
    { 2, 30, -1.5215330835075998427},
    { 2, 32, 4.9143631401769051365},
    { 2, 34, -12.625227502318289617},
    { 2, 45, 0.36685490255855924707},
    { 2, 47, -1.7508040432310286526},
    { 2, 49, 5.6301102705903863088},
    { 2, 51, -14.115433463291789647},
    { 2, 53, 30.899879470145692625},
    { 3,  2, -6.6773046252828340924},
    { 3,  7, -0.4141088534841251756},
    { 3,  9, 12.037682104175058775},
    { 3, 16, 0.36933647472336924992},
    { 3, 20, -14.404122514211400747},
    { 3, 29, 0.5176360668551564695},
    { 3, 31, -1.5716186128759850285},
    { 3, 33, 2.1085476318567772704},
    { 3, 35, 11.784751634792733297},
    { 3, 46, 0.83466307816035426155},
    { 3, 48, -3.0094205260437646938},
    { 3, 50, 7.2020612571057003733},
    { 3, 52, -11.784751634792733297},
    { 4,  4, -3.4481452815032230275},
    { 4, 11, -1.6751527923828483708},
    { 4, 13, 7.2589954336590096068},
    { 4, 22, -0.8375763961914241854},
    { 4, 24, 3.5420270866204483582},
    { 4, 26, -10.88849315048851441},
    { 4, 37, -0.43101816018790287844},
    { 4, 39, 1.8147488584147524017},
    { 4, 41, -5.4442465752442572051},
    { 4, 43, 13.607859057360933734},
    { 5,  0, -3.0039037101744789449},
    { 5,  3, 0.48872865531848218477},
    { 5,  5, 6.353472519140268402},
    { 5, 10, 0.60446869725999424174},
    { 5, 12, -1.8404912627435355792},
    { 5, 14, -7.8580930643799251427},
    { 5, 21, 0.42938691409402814694},
    { 5, 23, -1.8862541387657786692},
    { 5, 25, 4.2869412244676787937},
    { 5, 27, 5.5820298832223659102},
    { 5, 36, 0.27320762396104757397},
    { 5, 38, -1.3216021699045153767},
    { 5, 40, 3.9290465321899625713},
    { 5, 42, -7.4890789627922538015},
    { 6,  1, -2.1856609916883805917},
    { 6,  6, -0.70722550556663459495},
    { 6,  8, 5.286408679618061507},
    { 6, 15, -0.12089373945199884835},
    { 6, 17, 1.371821191829657214},
    { 6, 19, -7.8580930643799251427},
    { 6, 28, 0.12218216382962054619},
    { 6, 30, -0.2300614078429419474},
    { 6, 32, -0.85738824489353575873},
    { 6, 34, 7.4890789627922538015},
    { 6, 45, 0.37548796377180986812},
    { 6, 47, -1.5883681297850671005},
    { 6, 49, 3.9290465321899625713},
    { 6, 51, -5.5820298832223659102},
    { 7,  2, 3.2172058689087921765},
    { 7,  7, -1.9952263803447290557},
    { 7,  9, -4.461461816951664449},
    { 7, 16, -1.1270215191359871436},
    { 7, 18, 4.2715244837693692506},
    { 7, 20, 3.0251630250492286486},
    { 7, 29, -0.19952263803447290557},
    { 7, 31, 1.5532816304615888184},
    { 7, 33, -5.3140622702881455791},
    { 7, 46, 0.80430146722719804411},
    { 7, 48, -2.2307309084758322245},
    { 7, 50, 3.0251630250492286486},
    { 8,  4, 3.3227159337612037634},
    { 8, 13, -5.3807254048457946909},
    { 8, 22, -0.80710881072686920363},
    { 8, 24, 1.3127625787762591908},
    { 8, 26, 4.5736165941189254873},
    { 8, 37, -0.83067898344030094085},
    { 8, 39, 2.6903627024228973454},
    { 8, 41, -4.5736165941189254873},
    { 9,  0, 1.5854563617457277717},
    { 9,  3, -1.5477019848225075568},
    { 9,  5, -2.5795033080375125947},
    { 9, 10, -0.40411450890205248708},
    { 9, 12, 3.5493784084536631473},
    { 9, 14, 1.8078806977197084948},
    { 9, 21, 0.26662334015368174881},
    { 9, 25, -3.9451191165476867005},
    { 9, 36, 0.48066206207978815025},
    { 9, 38, -1.7885637389150448462},
    { 9, 40, 3.013134496199514158},
    {10,  1, 1.922648248319152601},
    {10,  6, -0.53324668030736349762},
    {10,  8, -3.5771274778300896924},
    {10, 15, -0.65934472505071721576},
    {10, 17, 2.0885924734664223709},
    {10, 19, 3.013134496199514158},
    {10, 28, -0.25795033080375125947},
    {10, 30, 1.4944751193489107989},
    {10, 32, -3.9451191165476867005},
    {10, 45, 0.39636409043643194293},
    {10, 47, -1.2897516540187562973},
    {10, 49, 1.8078806977197084948},
    {11,  2, -1.4892769292709880455},
    {11,  7, 2.6784699954533964589},
    {11,  9, 1.1703114569421253},
    {11, 16, -0.82375198049391484229},
    {11, 18, -3.055876127438741585},
    {11, 29, -1.2006934462377294471},
    {11, 31, 3.055876127438741585},
    {11, 46, 0.74463846463549402274},
    {11, 48, -1.1703114569421253},
    {12,  4, -2.3071778979829831212},
    {12, 11, 2.1171730857442902984},
    {12, 13, 2.1171730857442902984},
    {12, 22, 0.49815837311630359963},
    {12, 24, -3.4435822813708733235},
    {12, 37, -1.1535889489914915606},
    {12, 39, 2.1171730857442902984},
    {13,  0, -0.88629705005573611014},
    {13,  3, 1.970714454527131416},
    {13,  5, 0.81712550553563985542},
    {13, 10, -1.165203897824940261},
    {13, 12, -2.4854250434250426213},
    {13, 21, -0.62599730862026569616},
    {13, 23, 3.0875440833770900185},
    {13, 36, 0.75235513151094117345},
    {13, 38, -1.5864088739144064054},
    {14,  1, -1.5047102630218823469},
    {14,  6, 1.8779919258607970885},
    {14,  8, 1.5864088739144064054},
    {14, 15, -0.16645769968927718014},
    {14, 17, -3.0875440833770900185},
    {14, 28, -0.91325791795159748547},
    {14, 30, 2.4854250434250426213},
    {14, 45, 0.44314852502786805507},
    {14, 47, -0.81712550553563985542},
    {15,  2, 0.626706654240043952},
    {15,  7, -2.176535018670731151},
    {15, 16, 3.2353561313826025233},
    {15, 29, -2.176535018670731151},
    {15, 46, 0.626706654240043952},
    {16,  4, 1.2945196985754986958},
    {16, 11, -2.9348392204684739765},
    {16, 22, 2.9348392204684739765},
    {16, 37, -1.2945196985754986958},
    {17,  0, 0.60904939217552380708},
    {17,  3, -2.3781845426185916576},
    {17, 10, 4.1179360680974030877},
    {17, 21, -3.4414040330583097636},
    {17, 36, 1.3294455750836041652},
    {18,  1, 1.3294455750836041652},
    {18,  6, -3.4414040330583097636},
    {18, 15, 4.1179360680974030877},
    {18, 28, -2.3781845426185916576},
    {18, 45, 0.60904939217552380708},
};


typedef struct {
    long size;
    const type_sparse_el *elements;
} type_sparse_tf;


const static type_sparse_tf cptf[MAX_CON_TYPE+1] = {
    {1, cptf0}, {3, cptf1}, {8, cptf2}, {16, cptf3}, {29, cptf4}, {47, cptf5},
    {71, cptf6}, {102, cptf7}, {142, cptf8}, {192, cptf9}
};


void project_cartesian_to_pure(double *work_cart, double* work_pure, long
    con_type, long stride, long spacing, long count) {

    int c, npure, ncart, i;
    const type_sparse_tf* tf;
    const type_sparse_el* el;

    assert(con_type<=MAX_CON_TYPE);
    assert(con_type>0);

    npure = 2*con_type+1;
    ncart = ((con_type+1)*(con_type+2))/2;
    tf = &cptf[con_type];

    for (c=count-1; c>=0; c--) {
        // A) Reset elements in work_pure
        for (i=0; i<npure; i++) {
            work_pure[i*spacing] = 0.0;
        }

        // B) Write linear combinations in work_pure
        el = (*tf).elements;
        for (i=(*tf).size-1; i>=0; i--) {
            work_pure[(*el).ipure*spacing] += (*el).x*work_cart[(*el).icart*spacing];
            el++;
        }

        // C) Increment work arrays
        work_pure += stride;
        work_cart += stride;
    }
}
